<!DOCTYPE html>
<html xmlns:th="http//www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/layout}">
      
<head>
  <script>
    $(document).ready(function() {
        $('#checkDuplicateId').click(function() {
            var id = $('#inputId').val();
                // ID가 5자 이상 12자 이하의 영문자와 숫자로만 구성되어 있는지 검사
                var idPattern = /^[a-zA-Z0-9]{5,12}$/;
                if (!idPattern.test(id)) {
                    alert('ID는 5자 이상 12자 이하의 영문자와 숫자로만 입력 가능합니다.');
                    $('#signInBtn').prop('disabled', true);
                    return;
                }
                
                
                $.ajax({
                type: 'POST',
                url: '/check_duplicate_id',
                data: {id: id},
                success: function(response) {
                    if (response === 'available') {
                        alert('사용 가능한 ID입니다.');
                     //  $('#signInBtn').prop('disabled', false);

                        
                    } else {
                        alert('이미 존재하는 ID입니다.');
                        $('#signInBtn').prop('disabled', true);

                    }
                }
            });
            });    
               
               /*
          var pwdCheck1 = 
          		 $("#inputPassword").on('keyup',function() { 
				var pwd = $(this).val();
				var pwdPattern = /^[a-zA-Z0-9]{5,12}$/;
				
				
				if(pwd.length < 5 ) {
					 $("#passwordMessage").text("패스워드가 너무 짧습니다.").css("color", "red");
					 $('#signInBtn').prop('disabled', true);
       			 } else if (pwd.length > 12) {
        			  $("#passwordMessage").text("글자 수를 초과하였습니다.").css("color", "red");
        			  $('#signInBtn').prop('disabled', true);
			        } else if (!pwd.match(/[a-zA-Z]/)) {
			          $("#passwordMessage").html("영문자를 포함해 주세요.").css("color", "red");
			          $('#signInBtn').prop('disabled', true);
			        } else if (!pwd.match(/[0-9]/)) {
			          $("#passwordMessage").html("숫자를 포함해주세요.").css("color", "red");
			          $('#signInBtn').prop('disabled', true);
			        } else {
			          $("#passwordMessage").text("사용 가능한 비밀번호 입니다.").css("color", "green");
				}
			});
            	
            var pwdCheck2 =	
              $("#inputPassword1").on('keyup', function() {
		        var pwd1 = $(this).val();
		        var pwd = $("#inputPassword").val();
		
		        if (pwd1 !== pwd) {
		          $("#confirmPasswordMessage").text("비밀번호가 다릅니다.").css("color", "red");
		          $('#signInBtn').prop('disabled', true);
		        } else {
		          $("#confirmPasswordMessage").text("비밀번호가 일치합니다.").css("color", "green");
		        }
		      });
           
            */
            
        var pwdCheck1 = $("#inputPassword").on('keyup', function() { 
        var pwd = $(this).val();
        var pwdPattern = /^[a-zA-Z0-9]{5,12}$/;
        
        if(pwd.length < 5 ) {
            $("#passwordMessage").text("패스워드가 너무 짧습니다.").css("color", "red");
            $('#signInBtn').prop('disabled', true);
        } else if (pwd.length > 12) {
            $("#passwordMessage").text("글자 수를 초과하였습니다.").css("color", "red");
            $('#signInBtn').prop('disabled', true);
        } else if (!pwd.match(/[a-zA-Z]/)) {
            $("#passwordMessage").html("영문자를 포함해 주세요.").css("color", "red");
            $('#signInBtn').prop('disabled', true);
        } else if (!pwd.match(/[0-9]/)) {
            $("#passwordMessage").html("숫자를 포함해주세요.").css("color", "red");
            $('#signInBtn').prop('disabled', true);
        } else {
            $("#passwordMessage").text("사용 가능한 비밀번호 입니다.").css("color", "green");
        }
    });
    
    var pwdCheck2 = $("#inputPassword1").on('keyup', function() {
        var pwd1 = $(this).val();
        var pwd = $("#inputPassword").val();
        
        if (pwd1 !== pwd) {
            $("#confirmPasswordMessage").text("비밀번호가 다릅니다.").css("color", "red");
            $('#signInBtn').prop('disabled', true);
        } else {
            $("#confirmPasswordMessage").text("비밀번호가 일치합니다.").css("color", "green");
        }
    });
    
    // 두 이벤트 핸들러가 모두 실행되고, 메시지가 모두 green으로 설정되었을 때 signInBtn 활성화
    $("#inputPassword, #inputPassword1").on('keyup', function() {
        if ($("#passwordMessage").css("color") === "rgb(0, 128, 0)" && $("#confirmPasswordMessage").css("color") === "rgb(0, 128, 0)") {
            $('#signInBtn').prop('disabled', false);
        } else {
            $('#signInBtn').prop('disabled', true);
        }
    });


	
		 function checkInputs() {
        var id = $('#inputId').val();
        var pwd = $("#inputPassword").val();
        var pwd1 = $("#inputPassword1").val();
        var carNum = $("#inputCarNum").val();
        var email = $("#email").val();
        var phoneNum1 = $("#phoneNum1").val();
        var phoneNum2 = $("#phoneNum2").val();
        var phoneNum3 = $("#phoneNum3").val();

        // 하나라도 공백인 경우 signInBtn을 비활성화
        if (id.trim() === '' || pwd.trim() === '' || pwd1.trim() === '' || carNum.trim() === '' || email.trim() === '' || phoneNum1.trim() === '' || phoneNum2.trim() === '' || phoneNum3.trim() === '') {
            $('#signInBtn').prop('disabled', true);
        } else {
            $('#signInBtn').prop('disabled', false);
        }
    }

    // 모든 input 필드의 값이 변경될 때마다 checkInputs 함수 호출
    $("#inputId, #inputPassword, #inputPassword1, #inputCarNum, #email, #phoneNum1, #phoneNum2, #phoneNum3").on('keyup change', checkInputs);

    // 중복 확인 버튼 클릭 시 checkInputs 함수 호출
    $('#checkDuplicateId').click(checkInputs);
    
    
    }); //전체 스크립트 괄호
          
        
</script>


</head>

    <div layout:fragment="content">
    
	    <div class="card">
			  <div class="card-body">
					
					
					<form>
					<div class="row mb-3">
					    <label class="col-sm-2 col-form-label" for="inputId">ID</label>
					    <div class="col-sm-8 input-group">
					        <input type="text" class="form-control" id="inputId" placeholder="사용하실 ID를 입력하세요">
					    </div>
					  	  <p style="color: #2b8b5f; font-size: 12px;">아이디는 영문자와 숫자 5~12자 이하로 입력해주세요.</p>
					    <div class="col-sm-2">
					        <button type="button" class="btn btn-primary" id="checkDuplicateId">중복 확인</button>
					    </div>
					</div>


					<!-- 패스워드 -->
					  <div class="row mb-3">
					    <label for="inputPassword3" class="col-sm-2 col-form-label">비밀번호</label>
					    <div class="col-sm-10">
					      <input type="password" class="form-control" id="inputPassword">
							<p id="passwordMessage"></p>
					    </div>
					  </div>
					  
					<!-- 패스워드 확인 -->
					
				    <div class="row mb-3">
					    <label for="inputPassword3" class="col-sm-2 col-form-label">비밀번호 확인</label>
					    <div class="col-sm-10">
					      <input type="password" class="form-control" id="inputPassword1">
					   		<p id="confirmPasswordMessage"></p>
					    </div>
					  </div>
					
					
					
					 <!-- 차량번호-->
					  <div class="row mb-3">
					    <label for="carNum" class="col-sm-2 col-form-label">차량 번호</label>
					    <div class="col-sm-10">
					      <input type="text" class="form-control" id="inputCarNum">
					    </div>
					  </div>
					
					<!-- 이메일 -->
					  <div class="row mb-3">
					    <label for="email" class="col-sm-2 col-form-label">E-MAIL</label>
					    <div class="col-sm-10">
					      <input type="email" class="form-control" id="email">
					    </div>
					  </div>
					
					<!-- 핸드폰번호 -->
					  <div class="row mb-3">
					    <label for="phoneNum" class="col-sm-2 col-form-label">핸드폰 번호</label>
					    <div class="col-sm-10">
					      <input type="number" class="form-control" id="phoneNum1"> - 
					    </div>
					    
					    <div class="col-sm-10">
					      <input type="number" class="form-control" id="phoneNum2"> - 
					    </div>
					    
					    <div class="col-sm-10">
					      <input type="number" class="form-control" id="phoneNum3">
					    </div>
					  </div>
					  

					  </div>
					  <button type="submit" class="btn btn-primary" disabled id="signInBtn">Sign in</button>
					</form>
					
					
			  </div>
		</div>
    
			 <div data-bs-spy="scroll" data-bs-target="#navbar-example2" data-bs-root-margin="0px 0px -40%" data-bs-smooth-scroll="true" class="scrollspy-example bg-body-tertiary p-3 rounded-2" tabindex="0">
					  <h4 id="scrollspyHeading1">이용약관</h4>
					  <p>...SecondSecondSecondSecondSecondSecondSecondSecondSecondSecondSecondSecondSecondSecondSecondSecondSecondSecondSecondSecondSecondSecondSecondSecondSecondSecondSecondSecondSecondSecondSecondSecond</p>
					  <h4 id="scrollspyHeading2">Second heading</h4>
					  <p>...</p>
					  <h4 id="scrollspyHeading3">Third heading</h4>
					  <p>...</p>
					  <h4 id="scrollspyHeading4">Fourth heading</h4>
					  <p>...</p>
					  <h4 id="scrollspyHeading5">Fifth heading</h4>
					  <p>...</p>
					  
						<div class="form-check form-check-reverse">
						  <input class="form-check-input" type="checkbox" value="" id="reverseCheck1">
						  <label class="form-check-label" for="reverseCheck1">
						    약관 동의
						  </label>
						</div>
					</div>
					 
					
					
					
			  </div>
			  <div class="card-footer text-body-secondary">
			     <button type="submit" class="btn btn-primary">회원가입 하기</button>
			  </div>
        
    </div>

</html>